<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KRYNOS REBORN</title>
    
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <style>
        body { margin: 0; padding: 0; background: #050505; color: #E5E5E5; font-family: 'Inter', sans-serif; overflow: hidden; }
        * { box-sizing: border-box; }
        /* Scrollbar custom */
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: #0D0D0E; }
        ::-webkit-scrollbar-thumb { background: #262629; border-radius: 3px; }
        ::-webkit-scrollbar-thumb:hover { background: #00F2FF; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        // 1. ADAPTATION DES IMPORTS (C'est ici que Ã§a bloquait avant)
        const { useState, useEffect } = React;
        const { 
            BarChart3, Users, Folder, Settings, Plus, Trash2, Edit2, Power, 
            HardDrive, Shield, Terminal, Upload, FileCode, FileImage, 
            FileText, File, Download, X 
        } = lucide;

        // 2. TON CODE KRYNOS-REBUILD (AdaptÃ©)
        function App() {
            const [currentPage, setCurrentPage] = useState('dashboard');
            const [projects, setProjects] = useState([]);
            const [team, setTeam] = useState([]);
            const [files, setFiles] = useState([]);
            const [logs, setLogs] = useState([{ id: 1, timestamp: new Date().toISOString(), action: 'SYSTEM_START', details: 'KRYNOS initialized' }]);
            const [webhook, setWebhook] = useState('');
            
            const [showProjectModal, setShowProjectModal] = useState(false);
            const [showMemberModal, setShowMemberModal] = useState(false);
            const [showFileModal, setShowFileModal] = useState(null);
            const [editingProject, setEditingProject] = useState(null);
            const [editingMember, setEditingMember] = useState(null);
            
            const [projectForm, setProjectForm] = useState({ name: '', description: '', progress: 0 });
            const [memberForm, setMemberForm] = useState({ name: '', role: '', status: 'active' });
            
            const [terminalOutput, setTerminalOutput] = useState(['> KRYNOS Terminal v1.0', '> Type "help" for commands']);
            const [terminalInput, setTerminalInput] = useState('');

            // Chargement des donnÃ©es
            useEffect(() => {
                const load = (k) => JSON.parse(localStorage.getItem(`krynos_${k}`) || '[]');
                setProjects(load('projects'));
                setTeam(load('team'));
                setFiles(load('files'));
                setLogs(load('logs'));
                setWebhook(localStorage.getItem('krynos_webhook') || '');
            }, []);

            // Sauvegarde automatique
            useEffect(() => { localStorage.setItem('krynos_projects', JSON.stringify(projects)); }, [projects]);
            useEffect(() => { localStorage.setItem('krynos_team', JSON.stringify(team)); }, [team]);
            useEffect(() => { localStorage.setItem('krynos_files', JSON.stringify(files)); }, [files]);
            useEffect(() => { localStorage.setItem('krynos_logs', JSON.stringify(logs)); }, [logs]);
            useEffect(() => { localStorage.setItem('krynos_webhook', webhook); }, [webhook]);

            const addLog = (action, details) => {
                const newLog = { id: Date.now(), timestamp: new Date().toISOString(), action, details };
                setLogs(prev => [newLog, ...prev].slice(0, 100));
            };

            const sendDiscord = async (title, description, color = 0x00F2FF) => {
                if (!webhook) return;
                try {
                    await fetch(webhook, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            embeds: [{
                                title: `ðŸ”· KRYNOS | ${title}`,
                                description,
                                color,
                                timestamp: new Date().toISOString(),
                                footer: { text: 'KRYNOS Command Center' }
                            }]
                        })
                    });
                } catch (e) { console.error('Discord error:', e); }
            };

            const getFileIcon = (name) => {
                const ext = name.split('.').pop().toLowerCase();
                if (['jpg', 'png', 'gif', 'svg'].includes(ext)) return <FileImage size={18} />;
                if (['js', 'jsx', 'py', 'html'].includes(ext)) return <FileCode size={18} />;
                if (['txt', 'md', 'pdf'].includes(ext)) return <FileText size={18} />;
                return <File size={18} />;
            };

            // --- FONCTIONS LOGIQUES ---
            const addProject = () => {
                if (!projectForm.name) return;
                setProjects([...projects, { id: Date.now(), ...projectForm, createdAt: new Date().toISOString() }]);
                addLog('PROJECT_CREATE', `Created: ${projectForm.name}`);
                setShowProjectModal(false); setProjectForm({ name: '', description: '', progress: 0 });
            };

            const updateProject = () => {
                setProjects(projects.map(p => p.id === editingProject.id ? { ...p, ...projectForm } : p));
                setShowProjectModal(false); setEditingProject(null);
            };

            const deleteProject = (id) => {
                setProjects(projects.filter(p => p.id !== id));
                setFiles(files.filter(f => f.projectId !== id));
            };

            const addMember = () => {
                setTeam([...team, { id: Date.now(), ...memberForm, joinedAt: new Date().toISOString() }]);
                setShowMemberModal(false); setMemberForm({ name: '', role: '', status: 'active' });
            };

            const updateMember = () => {
                setTeam(team.map(m => m.id === editingMember.id ? { ...m, ...memberForm } : m));
                setShowMemberModal(false); setEditingMember(null);
            };

            const uploadFiles = (projectId, fileList) => {
                Array.from(fileList).forEach(file => {
                    const reader = new FileReader();
                    reader.onload = (e) => {
                        setFiles(prev => [...prev, {
                            id: Date.now() + Math.random(),
                            projectId,
                            name: file.name,
                            size: file.size,
                            data: e.target.result,
                            uploadedAt: new Date().toISOString()
                        }]);
                        addLog('FILE_UPLOAD', `${file.name} uploaded`);
                    };
                    reader.readAsDataURL(file);
                });
                setShowFileModal(null);
            };

            const runCommand = (cmd) => {
                const output = [...terminalOutput, `> ${cmd}`];
                if (cmd === 'help') output.push('Commands: status, clear, projects, team');
                else if (cmd === 'status') output.push(`Projects: ${projects.length} | Team: ${team.length}`);
                else if (cmd === 'clear') { setTerminalOutput(['> Cleared']); setTerminalInput(''); return; }
                else output.push(`Unknown: ${cmd}`);
                setTerminalOutput(output); setTerminalInput('');
            };

            // --- INTERFACE (JSX) ---
            const activeMembers = team.filter(m => m.status === 'active').length;

            return (
                <div style={{ display: 'flex', minHeight: '100vh', background: '#050505', color: '#E5E5E5' }}>
                    {/* SIDEBAR */}
                    <div style={{ width: '280px', background: '#0D0D0E', borderRight: '1px solid #1F1F21', padding: '30px 20px', display: 'flex', flexDirection: 'column' }}>
                        <div style={{ fontSize: '24px', fontWeight: 800, color: '#00F2FF', marginBottom: '40px', letterSpacing: '2px' }}>KRYNOS</div>
                        <nav style={{ flex: 1, display: 'flex', flexDirection: 'column', gap: '5px' }}>
                            {[
                                { id: 'dashboard', icon: BarChart3, label: 'Dashboard' },
                                { id: 'projects', icon: Folder, label: 'Projects' },
                                { id: 'team', icon: Users, label: 'Team' },
                                { id: 'storage', icon: HardDrive, label: 'Storage' },
                                { id: 'security', icon: Shield, label: 'Security' },
                                { id: 'terminal', icon: Terminal, label: 'Terminal' },
                                { id: 'settings', icon: Settings, label: 'Settings' }
                            ].map(item => (
                                <button key={item.id} onClick={() => setCurrentPage(item.id)} style={{
                                    display: 'flex', alignItems: 'center', gap: '12px', padding: '12px 16px',
                                    background: currentPage === item.id ? 'rgba(0, 242, 255, 0.08)' : 'transparent',
                                    border: 'none', borderRadius: '8px',
                                    color: currentPage === item.id ? '#00F2FF' : '#888',
                                    cursor: 'pointer', fontSize: '14px', fontWeight: 600, transition: '0.2s', textAlign:'left'
                                }}>
                                    <item.icon size={18} /> {item.label}
                                </button>
                            ))}
                        </nav>
                        <div style={{ fontSize: '12px', color: '#444', textAlign: 'center', padding: '10px', border: '1px solid #1F1F21', borderRadius: '8px' }}>
                            STATUS: {webhook ? 'ONLINE' : 'LOCAL'}
                        </div>
                    </div>

                    {/* MAIN CONTENT */}
                    <div style={{ flex: 1, padding: '40px', overflowY: 'auto' }}>
                        {currentPage === 'dashboard' && (
                            <div>
                                <h1 style={{ fontSize: '32px', fontWeight: 700, marginBottom: '30px' }}>Command Center</h1>
                                <div style={{ display: 'grid', gridTemplateColumns: 'repeat(4, 1fr)', gap: '20px', marginBottom: '40px' }}>
                                    <div style={{ background: '#161618', padding: '20px', borderRadius: '12px', border: '1px solid #262629' }}>
                                        <div style={{ color: '#888', fontSize: '12px' }}>PROJECTS</div>
                                        <div style={{ fontSize: '32px', fontWeight: 700 }}>{projects.length}</div>
                                    </div>
                                    <div style={{ background: '#161618', padding: '20px', borderRadius: '12px', border: '1px solid #262629' }}>
                                        <div style={{ color: '#888', fontSize: '12px' }}>TEAM ACTIVE</div>
                                        <div style={{ fontSize: '32px', fontWeight: 700, color: '#00F2FF' }}>{activeMembers}</div>
                                    </div>
                                </div>
                                <h3>Activity Logs</h3>
                                <div style={{ background: '#111', borderRadius: '12px', padding: '20px' }}>
                                    {logs.slice(0, 8).map(l => (
                                        <div key={l.id} style={{ display: 'flex', justifyContent: 'space-between', padding: '10px 0', borderBottom: '1px solid #222', fontSize: '13px' }}>
                                            <span style={{ color: '#00F2FF' }}>{l.action}</span>
                                            <span>{l.details}</span>
                                            <span style={{ color: '#444' }}>{new Date(l.timestamp).toLocaleTimeString()}</span>
                                        </div>
                                    ))}
                                </div>
                            </div>
                        )}

                        {currentPage === 'projects' && (
                            <div>
                                <div style={{ display: 'flex', justifyContent: 'space-between', marginBottom: '30px' }}>
                                    <h1>Projects</h1>
                                    <button onClick={() => setShowProjectModal(true)} style={{ background: '#00F2FF', border: 'none', padding: '10px 20px', borderRadius: '8px', fontWeight: 700, cursor: 'pointer' }}>+ NEW</button>
                                </div>
                                <div style={{ display: 'grid', gridTemplateColumns: 'repeat(2, 1fr)', gap: '20px' }}>
                                    {projects.map(p => (
                                        <div key={p.id} style={{ background: '#161618', padding: '24px', borderRadius: '12px', border: '1px solid #262629' }}>
                                            <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                                <h3>{p.name}</h3>
                                                <button onClick={() => deleteProject(p.id)} style={{ background: 'none', border: 'none', color: '#444', cursor: 'pointer' }}><Trash2 size={16}/></button>
                                            </div>
                                            <p style={{ color: '#888', fontSize: '14px' }}>{p.description}</p>
                                            <div style={{ height: '6px', background: '#333', borderRadius: '3px', marginTop: '10px', overflow: 'hidden' }}>
                                                <div style={{ width: `${p.progress}%`, height: '100%', background: '#00F2FF' }}></div>
                                            </div>
                                            <button onClick={() => setShowFileModal(p.id)} style={{ marginTop: '15px', width: '100%', padding: '8px', background: '#111', border: '1px solid #333', color: '#FFF', borderRadius: '6px', cursor: 'pointer', fontSize: '12px' }}>Upload File</button>
                                        </div>
                                    ))}
                                </div>
                            </div>
                        )}

                        {currentPage === 'team' && (
                            <div>
                                <div style={{ display: 'flex', justifyContent: 'space-between', marginBottom: '30px' }}>
                                    <h1>Team</h1>
                                    <button onClick={() => setShowMemberModal(true)} style={{ background: '#00F2FF', border: 'none', padding: '10px 20px', borderRadius: '8px', fontWeight: 700, cursor: 'pointer' }}>+ MEMBER</button>
                                </div>
                                <div style={{ display: 'grid', gridTemplateColumns: 'repeat(3, 1fr)', gap: '20px' }}>
                                    {team.map(m => (
                                        <div key={m.id} style={{ background: '#161618', padding: '20px', borderRadius: '12px', textAlign: 'center', border: '1px solid #262629' }}>
                                            <div style={{ width: '10px', height: '10px', background: m.status === 'active' ? '#00FF88' : '#444', borderRadius: '50%', margin: '0 auto 10px' }}></div>
                                            <h3>{m.name}</h3>
                                            <p style={{ color: '#888', fontSize: '13px' }}>{m.role}</p>
                                        </div>
                                    ))}
                                </div>
                            </div>
                        )}
                        
                        {currentPage === 'settings' && (
                            <div>
                                <h1>Settings</h1>
                                <div style={{ background: '#161618', padding: '30px', borderRadius: '12px', marginTop: '20px' }}>
                                    <label>Discord Webhook URL</label>
                                    <input type="password" value={webhook} onChange={e => setWebhook(e.target.value)} style={{ width: '100%', padding: '10px', marginTop: '10px', background: '#000', border: '1px solid #333', color: '#FFF', borderRadius: '6px' }} />
                                </div>
                            </div>
                        )}
                        
                        {/* TERMINAL, STORAGE, SECURITY PAGES would go here similarly */}
                    </div>

                    {/* MODALS */}
                    {showProjectModal && (
                        <div style={{ position: 'fixed', inset: 0, background: 'rgba(0,0,0,0.8)', display: 'flex', alignItems: 'center', justifyContent: 'center' }}>
                            <div style={{ background: '#111', padding: '30px', borderRadius: '16px', width: '400px', border: '1px solid #333' }}>
                                <h2>New Project</h2>
                                <input placeholder="Name" style={{ width: '100%', padding: '10px', marginBottom: '10px', background: '#000', border: '1px solid #333', color: '#FFF' }} onChange={e => setProjectForm({...projectForm, name: e.target.value})}/>
                                <button onClick={addProject} style={{ width: '100%', padding: '10px', background: '#00F2FF', border: 'none', fontWeight: 700, cursor: 'pointer' }}>CREATE</button>
                                <button onClick={() => setShowProjectModal(false)} style={{ width: '100%', padding: '10px', background: 'transparent', color: '#888', border: 'none', marginTop: '10px', cursor: 'pointer' }}>CANCEL</button>
                            </div>
                        </div>
                    )}
                    
                    {showFileModal && (
                        <div style={{ position: 'fixed', inset: 0, background: 'rgba(0,0,0,0.8)', display: 'flex', alignItems: 'center', justifyContent: 'center' }}>
                            <div style={{ background: '#111', padding: '30px', borderRadius: '16px', width: '400px', border: '1px solid #333', textAlign: 'center' }}>
                                <h2>Upload Files</h2>
                                <input type="file" multiple onChange={e => uploadFiles(showFileModal, e.target.files)} style={{ margin: '20px 0' }} />
                                <button onClick={() => setShowFileModal(null)} style={{ width: '100%', padding: '10px', background: 'transparent', color: '#888', border: '1px solid #333', marginTop: '10px', cursor: 'pointer' }}>CLOSE</button>
                            </div>
                        </div>
                    )}
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
